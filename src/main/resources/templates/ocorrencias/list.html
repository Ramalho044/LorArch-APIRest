<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: template(~{::title}, ~{::main})}">
<head>
    <meta charset="UTF-8">
    <title>Ocorrências</title>
</head>
<body>
<main>

    <div class="container-fluid min-vh-100 d-flex align-items-start justify-content-center"
         style="background: linear-gradient(135deg, #121310 0%, #121310 50%, #f0f2f5 100%); padding: 24px;">

        <div class="card shadow-lg border-0 rounded-4 w-100" style="max-width: 1100px; background:#f0f2f5;">
            <div class="card-body p-4 p-md-5">

                <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
                    <h1 class="h3 m-0 fw-bold" style="color:#121310;">Ocorrências</h1>
                    <div class="d-flex gap-2">
                        <a th:href="@{/}" class="btn btn-sm rounded-3 fw-semibold"
                           style="background:transparent; color:#121310; border:1px solid #121310;">Voltar</a>
                        <a th:href="@{/ocorrencias/novo}" class="btn btn-sm rounded-3 fw-semibold"
                           style="background:#121310; color:#f0f2f5; border:1px solid #121310;">+ Nova ocorrência</a>
                    </div>
                </div>

                <div th:if="${success}" class="alert alert-success rounded-3 py-2 px-3 mb-3"
                     th:text="${success}"
                     style="background:#e8f5e9; border:1px solid #b7e1be; color:#1e7e34;"></div>

                <div th:if="${error}" class="alert alert-danger rounded-3 py-2 px-3 mb-3"
                     th:text="${error}"
                     style="background:#fff1f1; border:1px solid #f0b5b5; color:#7a1f1f;"></div>

                <div class="table-responsive rounded-3" style="border:1px solid rgba(18,19,16,.15); background:#ffffff;">
                    <table class="table table-hover align-middle mb-0">
                        <thead style="background:#121310; color:#f0f2f5;">
                        <tr>
                            <th class="text-nowrap">ID</th>
                            <th class="text-nowrap">Data</th>
                            <th class="text-nowrap">Tipo</th>
                            <th class="text-nowrap">Moto</th>
                            <th class="text-nowrap">Setor</th>
                            <th class="text-nowrap">Custo</th>
                            <th class="text-nowrap text-center" style="width: 160px;">Ações</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="oc : ${ocorrencias}">
                            <td th:text="${oc.id}">1</td>
                            <td th:text="${#temporals.format(oc.data, 'dd/MM/yyyy')}">01/01/2025</td>
                            <td th:text="${oc.tipo}">Entrada</td>
                            <td th:text="${oc.moto.placa}">ABC1D23</td>
                            <td th:text="${oc.setor.nome}">Operações</td>
                            <td th:text="${#numbers.formatDecimal(oc.custo, 1, 'POINT', 2, 'COMMA')}">0,00</td>
                            <td class="text-center">
                                <div class="d-inline-flex gap-2">
                                    <a th:href="@{'/ocorrencias/' + ${oc.id} + '/editar'}"
                                       class="btn btn-sm rounded-3 fw-semibold"
                                       style="background:#ffffff; color:#121310; border:1px solid rgba(18,19,16,.25);">
                                        Editar
                                    </a>

                                    <form th:action="@{'/ocorrencias/' + ${oc.id} + '/excluir'}" method="post" class="d-inline m-0">
                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                        <button type="submit"
                                                class="btn btn-sm rounded-3 fw-semibold"
                                                style="background:transparent; color:#121310; border:1px solid rgba(18,19,16,.35);"
                                                onclick="return confirm('Confirma excluir?');">
                                            Excluir
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>

                        <tr th:if="${#lists.isEmpty(ocorrencias)}">
                            <td colspan="7" class="text-center py-4" style="color:rgba(18,19,16,.66);">
                                Nenhuma ocorrência encontrada.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-3 small text-end" style="color:rgba(18,19,16,.6);">
                    Total: <span th:text="${#lists.size(ocorrencias)}">0</span> registro(s)
                </div>

            </div>
        </div>
    </div>

</main>
</body>
</html>
